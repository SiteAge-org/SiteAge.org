---
import { BADGE_BASE_URL, WEB_BASE_URL } from "@siteage/shared";

interface Props {
  domain: string;
}

const { domain } = Astro.props;
const badgeUrl = `${BADGE_BASE_URL}/${domain}`;
const linkUrl = `${WEB_BASE_URL}/${domain}`;
---

<div class="bg-white/60 border border-divider p-6 sm:p-8">
  <h2 class="text-[10px] tracking-[0.3em] uppercase text-seal-dark font-medium mb-6">Badge</h2>

  <!-- Preview -->
  <div class="flex flex-col gap-5 mb-8">
    <div>
      <p class="text-[10px] tracking-[0.15em] uppercase text-ink-muted/50 mb-2">Flat</p>
      <img src={`${badgeUrl}?style=flat`} alt="SiteAge badge" class="h-5" />
    </div>
    <div>
      <p class="text-[10px] tracking-[0.15em] uppercase text-ink-muted/50 mb-2">Flat Square</p>
      <img src={`${badgeUrl}?style=flat-square`} alt="SiteAge badge" class="h-5" />
    </div>
    <div>
      <p class="text-[10px] tracking-[0.15em] uppercase text-ink-muted/50 mb-2">For the Badge</p>
      <img src={`${badgeUrl}?style=for-the-badge`} alt="SiteAge badge" class="h-7" />
    </div>
  </div>

  <!-- Embed codes -->
  <div class="space-y-4">
    <div>
      <label class="text-[10px] tracking-[0.15em] uppercase text-ink-muted/50 font-medium block mb-2">HTML</label>
      <div class="relative">
        <code class="block bg-parchment-dark rounded px-4 py-3 text-xs text-ink-muted font-mono overflow-x-auto" id="html-code">{`<a href="${linkUrl}"><img src="${badgeUrl}" alt="SiteAge badge"></a>`}</code>
        <button data-copy="html-code" class="copy-btn absolute top-2 right-2 text-[10px] tracking-[0.1em] uppercase px-2 py-1 bg-white border border-divider text-ink-muted hover:text-ink transition-colors">Copy</button>
      </div>
    </div>
    <div>
      <label class="text-[10px] tracking-[0.15em] uppercase text-ink-muted/50 font-medium block mb-2">Markdown</label>
      <div class="relative">
        <code class="block bg-parchment-dark rounded px-4 py-3 text-xs text-ink-muted font-mono overflow-x-auto" id="md-code">{`[![SiteAge](${badgeUrl})](${linkUrl})`}</code>
        <button data-copy="md-code" class="copy-btn absolute top-2 right-2 text-[10px] tracking-[0.1em] uppercase px-2 py-1 bg-white border border-divider text-ink-muted hover:text-ink transition-colors">Copy</button>
      </div>
    </div>
  </div>
</div>

<script>
  document.querySelectorAll<HTMLButtonElement>(".copy-btn").forEach((btn) => {
    btn.addEventListener("click", () => {
      const targetId = btn.getAttribute("data-copy");
      if (!targetId) return;
      const el = document.getElementById(targetId);
      if (!el) return;
      navigator.clipboard.writeText(el.textContent || "").then(() => {
        btn.textContent = "Copied!";
        setTimeout(() => { btn.textContent = "Copy"; }, 2000);
      });
    });
  });
</script>
