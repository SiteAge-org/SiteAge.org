---
import { BADGE_BASE_URL, WEB_BASE_URL } from "@siteage/shared";

interface Props {
  domain: string;
}

const { domain } = Astro.props;
const badgeUrl = `${BADGE_BASE_URL}/${domain}`;
const linkUrl = `${WEB_BASE_URL}/${domain}`;
---

<div class="bg-white rounded-lg border border-gray-200 p-6">
  <h2 class="text-sm font-semibold text-gray-500 uppercase tracking-wide mb-4">Badge</h2>

  <!-- Preview -->
  <div class="flex flex-col gap-4 mb-6">
    <div>
      <p class="text-xs text-gray-400 mb-2">Flat</p>
      <img src={`${badgeUrl}?style=flat`} alt="SiteAge badge" class="h-5" />
    </div>
    <div>
      <p class="text-xs text-gray-400 mb-2">Flat Square</p>
      <img src={`${badgeUrl}?style=flat-square`} alt="SiteAge badge" class="h-5" />
    </div>
    <div>
      <p class="text-xs text-gray-400 mb-2">For the Badge</p>
      <img src={`${badgeUrl}?style=for-the-badge`} alt="SiteAge badge" class="h-7" />
    </div>
  </div>

  <!-- Embed codes -->
  <div class="space-y-3">
    <div>
      <label class="text-xs font-medium text-gray-500 block mb-1">HTML</label>
      <div class="relative">
        <code class="block bg-gray-50 rounded px-3 py-2 text-xs text-gray-700 overflow-x-auto" id="html-code">{`<a href="${linkUrl}"><img src="${badgeUrl}" alt="SiteAge badge"></a>`}</code>
        <button data-copy="html-code" class="copy-btn absolute top-1 right-1 text-xs px-2 py-1 bg-white border border-gray-200 rounded text-gray-500 hover:text-gray-700">Copy</button>
      </div>
    </div>
    <div>
      <label class="text-xs font-medium text-gray-500 block mb-1">Markdown</label>
      <div class="relative">
        <code class="block bg-gray-50 rounded px-3 py-2 text-xs text-gray-700 overflow-x-auto" id="md-code">{`[![SiteAge](${badgeUrl})](${linkUrl})`}</code>
        <button data-copy="md-code" class="copy-btn absolute top-1 right-1 text-xs px-2 py-1 bg-white border border-gray-200 rounded text-gray-500 hover:text-gray-700">Copy</button>
      </div>
    </div>
  </div>
</div>

<script>
  document.querySelectorAll<HTMLButtonElement>(".copy-btn").forEach((btn) => {
    btn.addEventListener("click", () => {
      const targetId = btn.getAttribute("data-copy");
      if (!targetId) return;
      const el = document.getElementById(targetId);
      if (!el) return;
      navigator.clipboard.writeText(el.textContent || "").then(() => {
        btn.textContent = "Copied!";
        setTimeout(() => { btn.textContent = "Copy"; }, 2000);
      });
    });
  });
</script>
